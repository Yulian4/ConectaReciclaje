<div class="container-fluid vh-100 d-flex flex-column">
  <!-- Header -->
  <header class="d-flex align-items-center justify-content-between p-4 pb-2">
    <button class="btn btn-transparent text-dark p-0" (click)="navigateBack()">
      <span class="material-symbols-outlined fs-4">arrow_back</span>
    </button>
    <h2 class="fw-bold fs-5 mb-0 flex-grow-1 text-center">Reporte de Residuos</h2>
    <div style="width: 48px;"></div>
  </header>

  <!-- Material Type Selection -->
  <div class="px-4 py-3">
    <h3 class="fw-bold fs-5 mb-3">¿Qué tipo de residuo quieres reportar? <span class="text-danger">*</span></h3>
    <div class="d-flex flex-wrap gap-2">
      <button class="btn rounded-pill px-4 py-2 fw-medium d-flex align-items-center gap-2"
              [class.btn-primary]="reporte.tipo === 'carton'"
              [class.btn-outline-secondary]="reporte.tipo !== 'carton'"
              (click)="seleccionarTipo('carton')">
        <span class="material-symbols-outlined fs-6">inventory_2</span>
        Cartón
      </button>
      <button class="btn rounded-pill px-4 py-2 fw-medium d-flex align-items-center gap-2"
              [class.btn-primary]="reporte.tipo === 'plastico'"
              [class.btn-outline-secondary]="reporte.tipo !== 'plastico'"
              (click)="seleccionarTipo('plastico')">
        <span class="material-symbols-outlined fs-6">recycling</span>
        Plástico
      </button>
      <button class="btn rounded-pill px-4 py-2 fw-medium d-flex align-items-center gap-2"
              [class.btn-primary]="reporte.tipo === 'vidrio'"
              [class.btn-outline-secondary]="reporte.tipo !== 'vidrio'"
              (click)="seleccionarTipo('vidrio')">
        <span class="material-symbols-outlined fs-6">liquor</span>
        Vidrio
      </button>
      <button class="btn rounded-pill px-4 py-2 fw-medium d-flex align-items-center gap-2"
              [class.btn-primary]="reporte.tipo === 'metal'"
              [class.btn-outline-secondary]="reporte.tipo !== 'metal'"
              (click)="seleccionarTipo('metal')">
        <span class="material-symbols-outlined fs-6">construction</span>
        Metal
      </button>
      <button class="btn rounded-pill px-4 py-2 fw-medium d-flex align-items-center gap-2"
              [class.btn-primary]="reporte.tipo === 'otros'"
              [class.btn-outline-secondary]="reporte.tipo !== 'otros'"
              (click)="seleccionarTipo('otros')">
        <span class="material-symbols-outlined fs-6">category</span>
        Otros
      </button>
    </div>
  </div>

  <!-- Weight Selection -->
  <div class="px-4 py-3">
    <h3 class="fw-bold fs-5 mb-3">¿Cuánto pesa aproximadamente? <span class="text-danger">*</span></h3>
    <div class="d-flex flex-wrap gap-2">
      <button class="btn rounded-pill px-4 py-2 fw-medium"
              *ngFor="let opcion of pesoOpciones"
              [class.btn-primary]="reporte.pesoAproximado === opcion.valor"
              [class.btn-outline-secondary]="reporte.pesoAproximado !== opcion.valor"
              (click)="seleccionarPeso(opcion.valor)">
        {{opcion.texto}}
      </button>
    </div>
  </div>

  <!-- Address Section -->
  <div class="px-4 py-3">
    <h3 class="fw-bold fs-5 mb-3">¿Dónde podemos recogerlo? <span class="text-danger">*</span></h3>
    <div class="mb-3">
      <label class="form-label fw-medium">Dirección o punto de referencia</label>
      <div class="position-relative">
        <input type="text" class="form-control rounded-pill px-5 py-3 border-0 bg-light" placeholder="Ej: Calle 123 #45, cerca del parque central" [(ngModel)]="reporte.direccion">
        <span class="material-symbols-outlined position-absolute top-50 start-0 translate-middle-y ms-3 text-muted">location_on</span>
      </div>
    </div>
    
    <!-- Optional Description -->
    <div class="mb-3">
      <label class="form-label fw-medium">Descripción adicional (opcional)</label>
      <textarea class="form-control rounded-3 px-4 py-3 border-0 bg-light"
                rows="3"
                placeholder="Ej: Material en bolsas, horario preferido, instrucciones especiales..."
                [(ngModel)]="reporte.descripcion"></textarea>
    </div>
  </div>

  <!-- Contact Method Selection -->
  <div class="px-4 py-3">
    <h3 class="fw-bold fs-5 mb-3">¿Cómo prefieres que te contactemos? <span class="text-danger">*</span></h3>
    <div class="d-flex flex-wrap gap-2">
      <button class="btn rounded-pill px-4 py-2 fw-medium d-flex align-items-center gap-2"
              [class.btn-primary]="reporte.contacto === 'whatsapp'"
              [class.btn-outline-secondary]="reporte.contacto !== 'whatsapp'"
              (click)="seleccionarContacto('whatsapp')">
        <span class="material-symbols-outlined fs-6">chat</span>
        WhatsApp
      </button>
      <button class="btn rounded-pill px-4 py-2 fw-medium d-flex align-items-center gap-2"
              [class.btn-primary]="reporte.contacto === 'sms'"
              [class.btn-outline-secondary]="reporte.contacto !== 'sms'"
              (click)="seleccionarContacto('sms')">
        <span class="material-symbols-outlined fs-6">sms</span>
        SMS
      </button>
      <button class="btn rounded-pill px-4 py-2 fw-medium d-flex align-items-center gap-2"
              [class.btn-primary]="reporte.contacto === 'llamada'"
              [class.btn-outline-secondary]="reporte.contacto !== 'llamada'"
              (click)="seleccionarContacto('llamada')">
        <span class="material-symbols-outlined fs-6">call</span>
        Llamada
      </button>
      <button class="btn rounded-pill px-4 py-2 fw-medium d-flex align-items-center gap-2"
              [class.btn-primary]="reporte.contacto === 'web'"
              [class.btn-outline-secondary]="reporte.contacto !== 'web'"
              (click)="seleccionarContacto('web')">
        <span class="material-symbols-outlined fs-6">web</span>
        Web
      </button>
    </div>
  </div>

  <!-- Submit Button -->
  <div class="p-4 mt-auto">
    <button class="btn w-100 rounded-pill py-3 fw-bold fs-5"
            [class.btn-primary]="isFormValid()"
            [class.btn-secondary]="!isFormValid()"
            [disabled]="!isFormValid()"
            (click)="enviarReporte()">
      <span class="material-symbols-outlined me-2">send</span>
      Enviar Reporte
    </button>
    <p class="text-muted text-center mt-2 small">
      <span class="text-danger">*</span> Campos obligatorios
    </p>
  </div>

  <!-- Success Modal -->
  <div class="modal fade" id="successModal" tabindex="-1" [class.show]="showSuccessModal" [style.display]="showSuccessModal ? 'block' : 'none'">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content rounded-3 border-0">
        <div class="modal-body text-center p-6">
          <div class="d-flex align-items-center justify-content-center mb-4 bg-primary-20 rounded-circle mx-auto" style="width: 80px; height: 80px;">
            <span class="material-symbols-outlined fs-1 text-primary">check_circle</span>
          </div>
          <h3 class="fw-bold mb-2 text-dark">¡Gracias! Hemos registrado tu reporte.</h3>
          <p class="text-muted">Te avisaremos cuando un reciclador esté en camino.</p>
        </div>
      </div>
    </div>
  </div>
</div>
